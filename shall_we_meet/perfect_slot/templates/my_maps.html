<script>

var mymap = L.map('mapid').setView([52.232079, 21.006311], 9);

L.tileLayer('https://tile.thunderforest.com/neighbourhood/{z}/{x}/{y}.png?apikey=9f79bff8a5e4496c87bb5f2dc0faff40', {
    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://thunderforest.com/">Thunderforest</a>',
    maxZoom: 18,
}).addTo(mymap);


L.control.scale().addTo(mymap);

var markersLayer = L.markerClusterGroup();

var arcgisOnline = L.esri.Geocoding.arcgisOnlineProvider();

L.esri.Geocoding.geosearch({
providers: [
  arcgisOnline,
  L.esri.Geocoding.mapServiceProvider({
    label: 'States and Counties',
    url: 'https://sampleserver6.arcgisonline.com/arcgis/rest/services/Census/MapServer',
    layers: [2, 3],
    searchFields: ['NAME', 'STATE_NAME']
  })
]
}).addTo(mymap);

mymap.addLayer(markersLayer);


{#dodawanie punktów na mapie#}
{##}
{##}
{#function populateMap(data){#}
{#    for(i in data) {#}
{#    var title = data[i].title,#}
{#        loc = data[i].loc,#}
{#        author = data[i].author,#}
{#        hint = data[i].hint,#}
{#        address = data[i].address,#}
{#        marker = new L.Marker(new L.latLng(loc), {title: title, author: author, hint: hint} );#}
{#    marker.bindPopup('<b>'+title+'</b><br>'+author+'<br>'+address+'<br>'+'Wskazówka: '+hint);#}
{#    markersLayer.addLayer(marker);#}
{#    }#}
{#}#}
{#var map_books =  JSON.parse("{{ map_books }}");#}
{#var new_lat = map_books[0].loc[0];#}
{#var new_lon = map_books[0].loc[1];#}
{#populateMap(map_books);#}



</script>